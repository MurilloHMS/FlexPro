name: Deploy to GitHub Pages

on:
  push:
    branches:
      - master  # ou a branch que você deseja que dispare o deploy (por exemplo, master)

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # Checkout o código do repositório
      - name: Checkout repository
        uses: actions/checkout@v3

      # Instalar o .NET SDK (ajustado para .NET 9)
      - name: Set up .NET
        uses: actions/setup-dotnet@v3
        with:
          dotnet-version: '9.0'  # Versão do .NET 9.0

      # Restaurar dependências do Blazor
      - name: Restore dependencies
        run: dotnet restore

      # Build do projeto Blazor
      - name: Build Blazor project
        run: dotnet publish -c Release -o ./publish

      # Configurar o GitHub Pages
      - name: Deploy to GitHub Pages
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          branch: gh-pages  # A branch onde o site será publicado
          folder: ./publish/wwwroot  # O diretório com os arquivos compilados
          token: ${{ secrets.GH_TOKEN}}
          
      # Configura o cache (opcional) para acelerar os builds
      - name: Cache .NET
        uses: actions/cache@v3
        with:
          path: ~/.nuget/packages
          key: ${{ runner.os }}-dotnetcore-${{ hashFiles('**/*.csproj') }}
          restore-keys: |
            ${{ runner.os }}-dotnetcore-
